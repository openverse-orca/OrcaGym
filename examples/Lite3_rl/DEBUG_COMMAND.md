# 左右控制命令分析

## 当前代码状态

### 按键映射
- **A键（左）**：`lin_vel[1] = self.player_agent_lin_vel_y[self.terrain_type][1]` = **0.3**（正数）
- **D键（右）**：`lin_vel[1] = self.player_agent_lin_vel_y[self.terrain_type][0]` = **-0.3**（负数）

### 命令归一化过程

1. **原始速度值**：
   - A键（左）：0.3 m/s（正数）
   - D键（右）：-0.3 m/s（负数）

2. **归一化到 [-1, 1]**：
   - A键：`0.3 / 0.3 = 1.0`
   - D键：`-0.3 / 0.3 = -1.0`

3. **观测计算中的缩放**（乘以 max_cmd_vel = 0.8）：
   - A键：`1.0 * 0.8 = 0.8`
   - D键：`-1.0 * 0.8 = -0.8`

## 问题分析

虽然绝对值相同（0.3 m/s），但归一化后的值不同：
- A键：归一化后 = **1.0**（正数）
- D键：归一化后 = **-1.0**（负数）

策略可能对正负值的响应不同：
1. **训练数据不平衡**：训练时可能某个方向的数据更多
2. **策略偏差**：策略可能对正方向（1.0）响应更好，对负方向（-1.0）响应较差
3. **观测空间**：策略可能对正负命令的处理方式不同

## 原始legged_gym实现

在 `run_legged_sim.py` 中：
- **Q键（左）**：`lin_vel[1] = self.player_agent_lin_vel_y[self.terrain_type][0]` = **-0.3**（负数）
- **E键（右）**：`lin_vel[1] = self.player_agent_lin_vel_y[self.terrain_type][1]` = **0.3**（正数）

所以：
- 左移应该用 `[0]`（负数，-0.3）
- 右移应该用 `[1]`（正数，0.3）

## 建议修复

应该使用：
- **A键（左）**：`lin_vel[1] = self.player_agent_lin_vel_y[self.terrain_type][0]` = **-0.3**（负数）
- **D键（右）**：`lin_vel[1] = self.player_agent_lin_vel_y[self.terrain_type][1]` = **0.3**（正数）

这样归一化后：
- A键：`-0.3 / 0.3 = -1.0` → `-1.0 * 0.8 = -0.8`
- D键：`0.3 / 0.3 = 1.0` → `1.0 * 0.8 = 0.8`

如果左右还是反的，可能需要检查坐标系定义。

